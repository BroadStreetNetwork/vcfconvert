<?php/* +-----------------------------------------------------------------------+ | vCard to LDIF/CSV Converter                                           | | Version 0.7                                                           | |                                                                       | | Copyright (C) 2006-2007, Thomas Bruederli - Switzerland               | | Licensed under the GNU GPL                                            | |                                                                       | | Redistribution and use in source and binary forms, with or without    | | modification, are permitted provided that the following conditions    | | are met:                                                              | |                                                                       | | o Redistributions of source code must retain the above copyright      | |   notice, this list of conditions and the following disclaimer.       | | o Redistributions in binary form must reproduce the above copyright   | |   notice, this list of conditions and the following disclaimer in the | |   documentation and/or other materials provided with the distribution.| | o The names of the authors may not be used to endorse or promote      | |   products derived from this software without specific prior written  | |   permission.                                                         | |                                                                       | | THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS   | | "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT     | | LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR | | A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT  | | OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, | | SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT      | | LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, | | DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY | | THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT   | | (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE | | OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  | |                                                                       | +-----------------------------------------------------------------------+ | Author: Thomas Bruederli <thomas@brotherli.ch>                        | +-----------------------------------------------------------------------+*/// suppress php notices@ini_set('error_reporting', E_ALL&~E_NOTICE); // include the converter class filerequire_once('vcard_convert.php');if (!empty($_FILES['_vcards'])){	// instantiate a parser object	$conv = new vcard_convert();	// parse the vCard file	if ($conv->fromFile($_FILES['_vcards']['tmp_name']))	{		$ext = $_POST['_format']=='gmail' ? 'csv' : $_POST['_format'];		$fname = preg_replace('/\.[a-z]+$/i', '', $_FILES['_vcards']['name']);		header(sprintf('Content-Type: text/%s', $ext));		header(sprintf('Content-Disposition: attachment; filename="%s.%s"', preg_replace('/[^a-z0-9_\-\.\s]/i', '', $fname), $ext));		if ($_POST['_format']=='ldif')			print $conv->toLdif(!empty($_POST['_mailonly']));		else if ($_POST['_format']=='gmail')			print $conv->toGmail(!empty($_POST['_mailonly']));					else if ($_POST['_format']=='csv')		{			$header = $_POST['_header']==='1' ? TRUE : FALSE;			$delimiter = $_POST['_delimiter']=='tab' ? "\t" : $_POST['_delimiter'];			print $conv->toCSV($delimiter, !empty($_POST['_mailonly']), $header);		}		// stop script here		exit;	}	else		$GLOBALS['error_msg'] = "Could not parse vCard file. Either it is empty or of a format not supported.";}include('page.html');?>